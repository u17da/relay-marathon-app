# リレーマラソン管理・応援アプリ「RelayFun」 要件定義書

## 1. 概要
42.195kmのフルマラソンをチーム（リレー形式）で完走するためのタイム管理およびコミュニケーション支援Webアプリ。
ターゲットタイム（4時間）に対するペース管理と、特定チーム（太田ヨットスクール、徳永サーフィンスクール）に向けたユニークなデザインテーマによる「応援・エンタメ性」に主眼を置く。

## 2. レース条件・前提
- **距離**: 42.195km（フルマラソン）
- **コース構成**: 1周 約1.4km × 30周
- **制限時間**: 4時間（240分）
- **平均目標ペース**: 8分/周（キロ約5分42秒ペース）
- **参加形態**: 事前に決定された走者によるリレー形式（1チーム複数名）

## 3. アプリケーションフロー
### 1. ランディング（チーム選択）画面
- **機能**: 参加チームを選択してエントリーする。
- **特徴**: チームごとの世界観を表現したリッチなUI。
  - **太田ヨットスクール**: マリン/ヨットテーマ。爽やかな青と白、波のアニメーション。
  - **徳永ぶちアゲ♂Surfing☆スクール**: ギャルテーマ。派手なグラデーション、キラキラエフェクト、ギャル語。
  - **その他**: 汎用的なシンプルUI。

### 2. セットアップ画面
- **機能**: レース前の走順設定。
- **入力**: チーム名はマスタデータ（`runner_list.json`）より自動反映。
- **走順設定**: 全30周に対して、誰が走るかをプルダウンで割り当て。デフォルト順序からの変更が可能。
- **開始**: 設定完了後、「レース開始」ボタンで計測画面へ遷移。

### 3. レース計測・実行画面（メイン画面）
- **ヘッダー情報**:
  - 経過時間（HH:MM:SS）
  - 現在の周回数（例: 12 / 30 周）
  - 残り距離（km）
  - **ペース表示**: 目標（4時間完走ペース）に対する「貯金/借金」時間をリアルタイム表示（例: 2分30秒 速い！）。
- **ランナー情報**:
  - **Current Runner**: 現在走っている走者名を大きく表示。
  - **Next Runner**: 次の走者を表示し、準備を促す。
- **アクション**:
  - **「タスキ！」ボタン**: 画面中央の巨大なボタン。タップでラップ計測＆次走者へ切り替え。
  - **Undo**: 直前のラップ操作を取り消す（誤操作防止）。
  - **Reset**: レースを中断・リセットする（パスワード認証 `smed` 必須）。
  - **途中編集**: レース中に走順を変更するための設定モーダル呼び出し。
- **履歴**: 直近3周のラップタイムを表示。

### 4. 結果画面（Result）
- **機能**: 30周完走後に表示されるリザルト画面。
- **表示内容**:
  - 完走タイム（Total Time）
  - 全周回のラップタイムリスト
  - 祝福メッセージ（アニメーション付き）
- **アクション**: レースデータをクリアしてトップへ戻る。

## 4. 技術要件
### アーキテクチャ
- **Frontend**: React, Vite
- **Styling**: Tailwind CSS, clsx, tailwind-merge
- **Icons**: Lucide React
- **Data Persistence**: LocalStorage
  - チームIDごとにキーを分けてデータを保存（`relay-app-data-{teamId}`）。
  - ブラウザを閉じてもレース状況が復元される仕様。
- **Deploy**: Vercel (想定)

### データ構造 (`runner_list.json`)
- チームID、チーム名、メンバーリスト、デフォルト走順（assignments）を定義。

## 5. UI/UX デザイン方針
- **スマホファースト**: モバイル端末での操作・閲覧に最適化。
- **誤操作防止**: 疲労時でも押し間違えない「巨大ボタン」。
- **没入感**: チームごとのキャラクターに合わせた配色・演出（CSSアニメーション、背景装飾）。
- **ダークモード対応**: ベースはそれぞれのテーマカラーに準拠（一部固定）。

## 6. セキュリティ・運用
- **リセット保護**: レース中の誤リセットを防ぐため、簡易パスワード（`smed`）によるロック機能を実装。
